(()=>{var e={};e.id=40,e.ids=[40],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2381:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o}),t(3139),t(5659),t(5866),t(1506);var r=t(3191),a=t(8716),n=t(7922),i=t.n(n),l=t(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o=["",{children:["(app)",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3139)),"/Users/feridun/Documents/Projets/locamaster/app/(app)/dashboard/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,5659)),"/Users/feridun/Documents/Projets/locamaster/app/(app)/dashboard/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"/Users/feridun/Documents/Projets/locamaster/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/feridun/Documents/Projets/locamaster/app/(app)/dashboard/page.tsx"],x="/(app)/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(app)/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},7338:(e,s,t)=>{Promise.resolve().then(t.bind(t,7262))},1824:()=>{},7372:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},5303:()=>{},7262:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var r=t(326),a=t(7577);function n({className:e}){return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[r.jsx("polyline",{points:"23 4 23 10 17 10"}),r.jsx("polyline",{points:"1 20 1 14 7 14"}),r.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10"}),r.jsx("path",{d:"M20.49 15a9 9 0 0 1-14.85 3.36L1 14"})]})}function i({className:e}){return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[r.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),r.jsx("polyline",{points:"7 10 12 15 17 10"}),r.jsx("line",{x1:"12",x2:"12",y1:"15",y2:"3"})]})}function l({className:e}){return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[r.jsx("line",{x1:"7",y1:"17",x2:"17",y2:"7"}),r.jsx("polyline",{points:"7 7 17 7 17 17"})]})}function d({className:e}){return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[r.jsx("line",{x1:"7",y1:"7",x2:"17",y2:"17"}),r.jsx("polyline",{points:"17 7 7 7 7 17"})]})}function o(){let[e,s]=(0,a.useState)(30),[t,l]=(0,a.useState)(!1),[d,o]=(0,a.useState)(null),[f,v]=(0,a.useState)(null);async function w(){l(!0),v(null);try{let s=await fetch(`/api/dashboard/overview?days=${e}`,{cache:"no-store"}),t=await s.json();if(!s.ok||t?.ok===!1)throw Error(t?.error||`HTTP ${s.status}`);o(t)}catch(e){v(e?.message||"Erreur r\xe9seau")}finally{l(!1)}}let N=d?.totals,y=N?.growth??0;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold tracking-tight",children:"Aper\xe7u"}),(0,r.jsxs)("p",{className:"text-white/70 text-sm",children:["Vue synth\xe9tique des ",e," derniers jours."]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(c,{days:e,setDays:s,v:7}),r.jsx(c,{days:e,setDays:s,v:30}),r.jsx(c,{days:e,setDays:s,v:90}),(0,r.jsxs)("button",{onClick:w,className:"inline-flex items-center gap-2 rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-sm hover:bg-white/10",children:[r.jsx(n,{className:"h-4 w-4"})," Actualiser"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsx(x,{label:"Chiffre d’affaires",value:g(N?.gross),delta:y}),r.jsx(x,{label:"Commandes",value:N?.ordersCount?.toLocaleString("fr-FR")??"—"}),r.jsx(x,{label:"Panier moyen",value:g(N?.avgCart)}),r.jsx(x,{label:"Part \xe9tablissement (25%)",value:g(N?.schoolShare),accent:"emerald"})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[r.jsx(m,{title:"\xc9volution du CA",children:r.jsx(u,{note:"Brancher plus tard: s\xe9ries quotidiennes Supabase/Stripe"})}),r.jsx(m,{title:"R\xe9partition des revenus",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(h,{label:"LOCAMASTER (75%)",value:g(N?.locamasterShare)}),r.jsx(h,{label:"\xc9tablissements (25%)",value:g(N?.schoolShare)}),r.jsx("div",{className:"col-span-2 text-white/60 text-xs",children:"Bas\xe9 sur la p\xe9riode s\xe9lectionn\xe9e."})]})})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-4",children:[r.jsx(p,{title:"Derni\xe8res commandes",actions:r.jsx("a",{href:"/dashboard/orders",className:"text-sm text-white/80 underline",children:"Voir tout"}),columns:["Date","Client","Montant","Statut"],rows:(d?.recentOrders??[]).map(e=>[new Date(e.created_at).toLocaleString("fr-FR"),e.customer??"—",g(e.amount),r.jsx(b,{status:e.status},e.id)]),empty:"Aucune commande r\xe9cente."}),r.jsx(p,{title:"Prochains versements",actions:r.jsx("a",{href:"/dashboard/commissions",className:"text-sm text-white/80 underline",children:"D\xe9tails"}),columns:["Date","\xc9tablissement","Montant","Statut"],rows:(d?.nextPayouts??[]).map(e=>[new Date(e.date).toLocaleDateString("fr-FR"),e.school,g(e.amount),r.jsx(j,{status:e.status},e.id)]),empty:"Aucun versement planifi\xe9."})]}),r.jsx("div",{className:"flex items-center justify-end",children:(0,r.jsxs)("a",{href:`/api/dashboard/export?days=${e}`,className:"inline-flex items-center gap-2 rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-sm hover:bg-white/10",children:[r.jsx(i,{className:"h-4 w-4"})," Export CSV (p\xe9riode)"]})}),t&&r.jsx("div",{className:"text-white/70 text-sm",children:"Chargement…"}),f&&(0,r.jsxs)("div",{className:"text-red-400 text-sm",children:["Erreur : ",f]}),d?.note&&r.jsx("div",{className:"text-white/60 text-xs",children:d.note})]})}function c({days:e,setDays:s,v:t}){let a=e===t;return(0,r.jsxs)("button",{onClick:()=>s(t),className:`rounded-lg px-3 py-2 text-sm border ${a?"border-white/30 bg-white/10":"border-white/15 bg-white/5 hover:bg-white/10"}`,children:[t," j"]})}function x({label:e,value:s,delta:t,accent:a}){let n=(t??0)>=0;return(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/[.04] p-4",children:[r.jsx("div",{className:"text-white/70 text-xs uppercase",children:e}),r.jsx("div",{className:"mt-1 text-2xl font-extrabold tabular-nums",children:s}),"number"==typeof t&&(0,r.jsxs)("div",{className:`mt-1 inline-flex items-center gap-1 text-xs ${n?"text-emerald-400":"text-red-400"}`,children:[n?r.jsx(l,{className:"h-3.5 w-3.5"}):r.jsx(d,{className:"h-3.5 w-3.5"}),n?"+":"",t.toFixed(1),"%"]}),"emerald"===a&&r.jsx("div",{className:"mt-3 h-1.5 w-full rounded bg-emerald-500/30",children:r.jsx("div",{className:"h-1.5 w-2/3 rounded bg-emerald-400"})})]})}function m({title:e,children:s}){return(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/[.04] p-4",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("div",{className:"font-semibold",children:e})}),r.jsx("div",{className:"mt-3 h-[240px] rounded-xl border border-white/10 bg-black/20 grid place-items-center",children:s})]})}function u({note:e}){return(0,r.jsxs)("div",{className:"text-center text-white/60 text-xs",children:[r.jsx("div",{className:"mb-2",children:"\uD83D\uDCC8 Graphique \xe0 brancher"}),e&&r.jsx("div",{children:e})]})}function h({label:e,value:s}){return(0,r.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/[.04] p-3",children:[r.jsx("div",{className:"text-xs text-white/70",children:e}),r.jsx("div",{className:"text-lg font-bold tabular-nums",children:s})]})}function p({title:e,actions:s,columns:t,rows:a,empty:n}){return(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/[.04] p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("div",{className:"font-semibold",children:e}),s]}),r.jsx("div",{className:"overflow-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsx("tr",{className:"text-left text-white/60",children:t.map(e=>r.jsx("th",{className:"py-2 pr-3 font-medium",children:e},e))})}),r.jsx("tbody",{children:0===a.length?r.jsx("tr",{children:r.jsx("td",{colSpan:t.length,className:"py-6 text-white/60",children:n})}):a.map((e,s)=>r.jsx("tr",{className:"border-t border-white/10",children:e.map((e,s)=>r.jsx("td",{className:"py-2 pr-3",children:e},s))},s))})]})})]})}function b({status:e}){return r.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-xs ${{paid:"bg-emerald-500/20 text-emerald-300 border-emerald-400/30",pending:"bg-amber-500/20 text-amber-300 border-amber-400/30",refunded:"bg-blue-500/20 text-blue-300 border-blue-400/30",failed:"bg-red-500/20 text-red-300 border-red-400/30"}[e]}`,children:e})}function j({status:e}){return r.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-xs ${{scheduled:"bg-indigo-500/20 text-indigo-300 border-indigo-400/30",paid:"bg-emerald-500/20 text-emerald-300 border-emerald-400/30",onhold:"bg-amber-500/20 text-amber-300 border-amber-400/30"}[e]}`,children:e})}function g(e){return"number"!=typeof e?"—":e.toLocaleString("fr-FR",{style:"currency",currency:"EUR",maximumFractionDigits:0})}},5659:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});var r=t(9510);function a({children:e}){return r.jsx("main",{className:"min-h-screen bg-[#0b0b0b] text-white",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})})}},3139:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`/Users/feridun/Documents/Projets/locamaster/app/(app)/dashboard/page.tsx#default`)},1506:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});var r=t(9510);function a({children:e}){return r.jsx("html",{lang:"fr",className:"h-full bg-[#0b0b0b]",children:(0,r.jsxs)("body",{className:"min-h-screen h-full bg-[#0b0b0b] text-white antialiased",children:[r.jsx("div",{className:"site-bg site-bg-breath","aria-hidden":"true"}),r.jsx("div",{className:"relative z-10",children:e})]})})}t(7272)},7272:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,471],()=>t(2381));module.exports=r})();